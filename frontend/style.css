/* 
 * Airtable Interface Extensions Stylesheet with Tailwind CSS
 * ============================================================
 * This file provides Tailwind CSS with design tokens mapped from Airtable's design system. 
 *
 * How it works:
 * -------------
 * - Tailwind CSS v3 is imported via @tailwind directives below
 * - Custom design tokens are configured in `tailwind.config.js`
 * - You can use Tailwind utility classes that automatically match Airtable's design system
 * - Example: `bg-gray-gray50` uses Airtable's gray50 color
 *
 * **This Stylesheet is optional!**
 * --------------------------------
 * You are *not* required to use Tailwind. To opt-out:
 * 1. Remove the `import './style.css';` line from `index.tsx`.
 * 2. Remove the bundler configuration from `block.json`.
 * 3. (Optional) Delete the `style.css`, `bundler.js`, and `tailwind.config.js` files.
 *
 * Using Tailwind classes:
 * ----------------------
 * You can use Tailwind classes that are mapped to Airtable's design tokens:
 * - Colors: `text-gray-gray900` (uses Airtable's gray900), `bg-blue-blue` (uses Airtable's blue)
 * - Spacing: `p-4` (16px), `m-2` (8px) 
 * - Typography: `text-base` (13px, Airtable's body-default), `font-display` (Inter Display)
 * - Shadows: `shadow-sm` (uses Airtable's elevation-low)
 */

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom styles for QR code scanner */
#html5qr-code-full-region {
  max-width: 350px;
  max-height: 350px;
  border: none !important;
}

#html5qr-code-full-region > div {
  max-width: 350px !important;
  max-height: 350px !important;
  border: none !important;
}

#html5qr-code-full-region video {
  max-width: 350px !important;
  max-height: 350px !important;
  object-fit: cover;
}

/* Hide base64 images */
#html5qr-code-full-region img[src^="data:image"] {
  display: none !important;
}

/* Hide scan region content when not actively scanning (only hide when no video or canvas) 
   ⚠️ COMPATIBILITY WARNING: :has() selector requires Safari iOS 15.4+, Firefox 121+
   For older browsers, consider using JavaScript to add/remove classes instead */
#html5qr-code-full-region__scan_region:not(:has(video)):not(:has(canvas[style*="display: inline-block"])):not(:has(canvas[style*="display: block"])) {
  min-height: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Show scan region when canvas is visible (image file scanning) 
   ⚠️ COMPATIBILITY WARNING: :has() selector requires Safari iOS 15.4+, Firefox 121+ */
#html5qr-code-full-region__scan_region:has(canvas[style*="display: inline-block"]),
#html5qr-code-full-region__scan_region:has(canvas[style*="display: block"]) {
  min-height: auto !important;
  height: auto !important;
  overflow: visible !important;
}

/* Fallback for browsers without :has() support - add this class via JavaScript */
#html5qr-code-full-region__scan_region.scanning-inactive {
  min-height: 0 !important;
  height: 0 !important;
  overflow: hidden !important;
  padding: 0 !important;
  margin: 0 !important;
}

/* Remove black border from scan region */
#html5qr-code-full-region__scan_region {
  border: none !important;
}

/* Style canvas elements */
#html5qr-code-full-region__scan_region canvas {
  border-radius: 12px !important;
  max-width: 100% !important;
  height: auto !important;
}

/* Enhanced button styles for QR scanner */
.html5-qrcode-element {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
  font-weight: 600;
  transition: all 0.2s ease-in-out;
}

/* Request Camera Permission button */
#html5-qrcode-button-camera-permission {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
  color: white !important;
  border: none !important;
  border-radius: 10px !important;
  padding: 12px 24px !important;
  font-size: 14px !important;
  cursor: pointer !important;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06) !important;
  min-width: 220px !important;
  text-transform: none !important;
}

#html5-qrcode-button-camera-permission:hover {
  -webkit-transform: translateY(-2px) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15), 0 4px 6px rgba(0, 0, 0, 0.1) !important;
}

#html5-qrcode-button-camera-permission:active {
  -webkit-transform: translateY(0) !important;
  transform: translateY(0) !important;
}

/* File selection button */
#html5-qrcode-button-file-selection {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%) !important;
  color: white !important;
  border: none !important;
  border-radius: 10px !important;
  padding: 12px 24px !important;
  font-size: 14px !important;
  cursor: pointer !important;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06) !important;
  min-width: 220px !important;
  text-transform: none !important;
}

#html5-qrcode-button-file-selection:hover {
  -webkit-transform: translateY(-2px) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15), 0 4px 6px rgba(0, 0, 0, 0.1) !important;
}

#html5-qrcode-button-file-selection:active {
  -webkit-transform: translateY(0) !important;
  transform: translateY(0) !important;
}

/* Start/Stop scanning buttons */
#html5-qrcode-button-camera-start,
#html5-qrcode-button-camera-stop {
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%) !important;
  color: white !important;
  border: none !important;
  border-radius: 10px !important;
  padding: 12px 24px !important;
  font-size: 14px !important;
  cursor: pointer !important;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06) !important;
  min-width: 220px !important;
  text-transform: none !important;
  font-weight: 600 !important;
}

#html5-qrcode-button-camera-start:hover,
#html5-qrcode-button-camera-stop:hover {
  -webkit-transform: translateY(-2px) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15), 0 4px 6px rgba(0, 0, 0, 0.1) !important;
}

#html5-qrcode-button-camera-start:active,
#html5-qrcode-button-camera-stop:active {
  -webkit-transform: translateY(0) !important;
  transform: translateY(0) !important;
}

/* Stop scanning button - different color for distinction */
#html5-qrcode-button-camera-stop {
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%) !important;
}

/* Select camera dropdown - proper dropdown styling */
select.html5-qrcode-element {
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
  background: white !important;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E") !important;
  background-repeat: no-repeat !important;
  background-position: right 16px center !important;
  color: #333 !important;
  border: 2px solid #e0e0e0 !important;
  border-radius: 8px !important;
  padding: 10px 16px !important;
  padding-right: 40px !important;
  font-size: 14px !important;
  cursor: pointer !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important;
  min-width: 280px !important;
  text-transform: none !important;
  font-weight: 500 !important;
  transition: all 0.2s ease-in-out !important;
}

select.html5-qrcode-element:hover {
  border-color: #4facfe !important;
  box-shadow: 0 2px 8px rgba(79, 172, 254, 0.2) !important;
}

select.html5-qrcode-element:focus {
  outline: none !important;
  border-color: #4facfe !important;
  box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1) !important;
}

/* Hide "Scan an Image File" link when video is active (scanning) 
   ⚠️ COMPATIBILITY WARNING: :has() selector requires Safari iOS 15.4+, Firefox 121+ */
#html5qr-code-full-region__scan_region:has(video) ~ #html5qr-code-full-region__dashboard #html5-qrcode-anchor-scan-type-change {
  display: none !important;
}

/* Alternative: Hide the scan type change link when camera is running 
   ⚠️ COMPATIBILITY WARNING: :has() selector requires Safari iOS 15.4+, Firefox 121+ */
#html5qr-code-full-region:has(video[style*="display: block"]) #html5-qrcode-anchor-scan-type-change,
#html5qr-code-full-region:has(video:not([style*="display: none"])) #html5-qrcode-anchor-scan-type-change {
  display: none !important;
}

/* Fallback for browsers without :has() support - add this class via JavaScript */
#html5-qrcode-anchor-scan-type-change.camera-active {
  display: none !important;
}

/* Scan type change link */
#html5-qrcode-anchor-scan-type-change {
  color: #667eea !important;
  font-size: 15px !important;
  font-weight: 600 !important;
  text-decoration: none !important;
  padding: 12px 24px !important;
  display: inline-block !important;
  border-radius: 8px !important;
  transition: all 0.2s ease-in-out !important;
}

#html5-qrcode-anchor-scan-type-change:hover {
  background-color: rgba(102, 126, 234, 0.1) !important;
  -webkit-transform: translateY(-1px) !important;
  transform: translateY(-1px) !important;
}

/* Dashboard section spacing */
#html5qr-code-full-region__dashboard_section {
  padding: 20px 0px !important;
}

#html5qr-code-full-region__dashboard_section > div {
  display: flex !important;
  flex-direction: column !important;
  gap: 16px !important;
  align-items: center !important;
}

/* File drop zone styling */
#html5qr-code-full-region__dashboard_section > div > div[style*="dashed"] {
  border-color: #e0e0e0 !important;
  border-width: 3px !important;
  border-radius: 12px !important;
  padding: 20px !important;
  background-color: #fafafa !important;
  transition: all 0.2s ease-in-out !important;
}

/* Only apply flex layout when the drop zone is visible (display: block) */
#html5qr-code-full-region__dashboard_section > div > div[style*="dashed"][style*="display: block"] {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  justify-content: center !important;
}

#html5qr-code-full-region__dashboard_section > div > div[style*="dashed"] label {
  display: flex !important;
  justify-content: center !important;
  width: 100% !important;
}

#html5qr-code-full-region__dashboard_section > div > div[style*="dashed"]:hover {
  border-color: #f5576c !important;
  background-color: #fff5f7 !important;
}

/* Camera viewport container - only style when video is present 
   ⚠️ COMPATIBILITY WARNING: :has() selector requires Safari iOS 15.4+, Firefox 121+ */
#html5qr-code-full-region__scan_region:has(video) {
  border-radius: 12px !important;
  overflow: hidden !important;
  background-color: transparent !important;
}

/* Fallback for browsers without :has() support - add this class via JavaScript */
#html5qr-code-full-region__scan_region.has-video {
  border-radius: 12px !important;
  overflow: hidden !important;
  background-color: transparent !important;
}

/* Ensure buttons are centered and spaced properly */
#html5qr-code-full-region__dashboard_section_csr > div {
  margin-bottom: 16px !important;
}

/* Add gap between camera selector and start button */
#html5qr-code-full-region__dashboard_section_csr span {
  display: inline-block !important;
  margin-bottom: 12px !important;
}

#html5qr-code-button-camera-start,
#html5qr-code-button-camera-stop {
  margin-top: 12px !important;
}

/* Hide camera selector when scanning is active (when stop button is visible) */
#html5-qrcode-button-camera-stop:not([style*="display: none"]) ~ span:has(#html5-qrcode-select-camera),
#html5qr-code-full-region__dashboard_section_csr:has(#html5-qrcode-button-camera-stop:not([style*="display: none"])) #html5-qrcode-select-camera {
  display: none !important;
}

/* Hide the "Select Camera" label text when scanning */
#html5qr-code-full-region__dashboard_section_csr:has(#html5-qrcode-button-camera-stop:not([style*="display: none"])) span {
  display: none !important;
}

/* But keep the stop button visible */
#html5qr-code-full-region__dashboard_section_csr:has(#html5-qrcode-button-camera-stop:not([style*="display: none"])) span:has(#html5-qrcode-button-camera-stop) {
  display: inline-block !important;
}
